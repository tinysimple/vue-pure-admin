var re=Object.defineProperty;var P=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var $=(e,r,t)=>r in e?re(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,M=(e,r)=>{for(var t in r||(r={}))ue.call(r,t)&&$(e,t,r[t]);if(P)for(var t of P(r))ie.call(r,t)&&$(e,t,r[t]);return e};var H=(e,r,t)=>new Promise((T,s)=>{var x=o=>{try{c(t.next(o))}catch(h){s(h)}},m=o=>{try{c(t.throw(o))}catch(h){s(h)}},c=o=>o.done?T(o.value):Promise.resolve(o.value).then(x,m);c((t=t.apply(e,r)).next())});import{S as oe}from"./sortable.esm-VSgMS8pS.js";import{d as ce,p as v,a8 as b,M as se,aX as de,br as D,t as N,b as a,au as fe,w,S as K,j as E,r as i,f as S,u as G,z as g,Z as ve,F as he,a3 as be,a1 as me,A as pe,bn as ge,ax as xe,n as Ce,c as ye,o as ke,e as we}from"./index-BbxVbw8z.js";import{u as Ee}from"./epTheme-Br2JOZW9.js";import{E as Re,R as Be,C as Ae,D as De,S as Se}from"./collapse-Bv17MkUI.js";function Te(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ge(e)}const ze={title:{type:String,default:"列表"},tableRef:{type:Object},columns:{type:Array,default:()=>[]},isExpandAll:{type:Boolean,default:!0},tableKey:{type:[String,Number],default:"0"}},Fe=ce({name:"PureTableBar",props:ze,emits:["refresh","fullscreen"],setup(e,{emit:r,slots:t,attrs:T}){const s=v("default"),x=v(!1),m=v(!0),c=v(!1),o=v(!1),h=pe(),C=v(e.isExpandAll),I=b(e==null?void 0:e.columns).filter(l=>se(l==null?void 0:l.hide)?!l.hide:!(de(l==null?void 0:l.hide)&&(l!=null&&l.hide())));let p=D(b(e==null?void 0:e.columns),"label");const R=v(D(b(I),"label")),d=v(b(e==null?void 0:e.columns)),z=N(()=>l=>({background:l===s.value?Ee().epThemeColor:"",color:l===s.value?"#fff":"var(--el-text-color-primary)"})),y=N(()=>["text-black","dark:text-white","duration-100","hover:text-primary!","cursor-pointer","outline-hidden"]),L=N(()=>["flex","justify-between","pt-[3px]","px-[11px]","border-b-[1px]","border-solid","border-[#dcdfe6]","dark:border-[#303030]"]);function U(){x.value=!0,r("refresh"),be(500).then(()=>x.value=!1)}function X(){C.value=!C.value,O(e.tableRef.data,C.value)}function Z(){c.value=!c.value,r("fullscreen",c.value)}function O(l,u){l.forEach(n=>{e.tableRef.toggleRowExpansion(n,u),n.children!==void 0&&n.children!==null&&O(n.children,u)})}function q(l){R.value=l?p:[],o.value=!1,d.value.map(u=>l?u.hide=!1:u.hide=!0)}function J(l){R.value=l;const u=l.length;m.value=u===p.length,o.value=u>0&&u<p.length}function Q(l,u){d.value.filter(n=>g(n.label)===g(u))[0].hide=!l}function W(){return H(this,null,function*(){m.value=!0,o.value=!1,d.value=b(e==null?void 0:e.columns),p=[],p=yield D(b(e==null?void 0:e.columns),"label"),R.value=D(b(I),"label")})}const Y={dropdown:()=>a(i("el-dropdown-menu"),{class:"translation"},{default:()=>[a(i("el-dropdown-item"),{style:z.value("large"),onClick:()=>s.value="large"},{default:()=>[S("宽松")]}),a(i("el-dropdown-item"),{style:z.value("default"),onClick:()=>s.value="default"},{default:()=>[S("默认")]}),a(i("el-dropdown-item"),{style:z.value("small"),onClick:()=>s.value="small"},{default:()=>[S("紧凑")]})]})},ee=l=>{l.preventDefault(),me(()=>{var n;const u=((n=h==null?void 0:h.proxy)==null?void 0:n.$refs[`GroupRef${G(e.tableKey)}`]).$el.firstElementChild;oe.create(u,{animation:300,handle:".drag-btn",onEnd:({newIndex:k,oldIndex:f,item:te})=>{const F=te,j=F.parentNode,V=d.value[f],_=d.value[k];if(V!=null&&V.fixed||_!=null&&_.fixed){const A=j.children[f];k>f?j.insertBefore(F,A):j.insertBefore(F,A&&A.nextElementSibling);return}const ne=d.value.splice(f,1)[0];d.value.splice(k,0,ne)}})})},le=l=>!!d.value.filter(u=>g(u.label)===g(l))[0].fixed,B=l=>({content:l,offset:[0,18],duration:[300,0],followCursor:!0,hideOnClick:"toggle"}),ae={reference:()=>w(a(Se,{class:["w-[16px]",y.value]},null),[[E("tippy"),B("列设置")]])};return()=>{var u;let l;return a(K,null,[a("div",fe(T,{class:["w-full","px-2","pb-2","bg-bg_color",c.value?["h-full!","z-2002","fixed","inset-0"]:"mt-2"]}),[a("div",{class:"flex justify-between w-full h-[60px] p-4"},[t!=null&&t.title?t.title():a("p",{class:"font-bold truncate"},[e.title]),a("div",{class:"flex items-center justify-around"},[t!=null&&t.buttons?a("div",{class:"flex mr-4"},[t.buttons()]):null,(u=e.tableRef)!=null&&u.size?a(K,null,[w(a(Re,{class:["w-[16px]",y.value],style:{transform:C.value?"none":"rotate(-90deg)"},onClick:()=>X()},null),[[E("tippy"),B(C.value?"折叠":"展开")]]),a(i("el-divider"),{direction:"vertical"},null)]):null,w(a(Be,{class:["w-[16px]",y.value,x.value?"animate-spin":""],onClick:()=>U()},null),[[E("tippy"),B("刷新")]]),a(i("el-divider"),{direction:"vertical"},null),w(a(i("el-dropdown"),{trigger:"click"},M({default:()=>[a(Ae,{class:["w-[16px]",y.value]},null)]},Y)),[[E("tippy"),B("密度")]]),a(i("el-divider"),{direction:"vertical"},null),a(i("el-popover"),{placement:"bottom-start","popper-style":{padding:0},width:"200",trigger:"click"},M({default:()=>[a("div",{class:[L.value]},[a(i("el-checkbox"),{class:"-mr-1!",label:"列展示",modelValue:m.value,"onUpdate:modelValue":n=>m.value=n,indeterminate:o.value,onChange:n=>q(n)},null),a(i("el-button"),{type:"primary",link:!0,onClick:()=>W()},{default:()=>[S("重置")]})]),a("div",{class:"pt-[6px] pl-[11px]"},[a(i("el-scrollbar"),{"max-height":"36vh"},{default:()=>[a(i("el-checkbox-group"),{ref:`GroupRef${G(e.tableKey)}`,modelValue:R.value,onChange:n=>J(n)},{default:()=>[a(i("el-space"),{direction:"vertical",alignment:"flex-start",size:0},Te(l=p.map((n,k)=>a("div",{class:"flex items-center"},[a(De,{class:["drag-btn w-[16px] mr-2",le(n)?"cursor-no-drop!":"cursor-grab!"],onMouseenter:f=>ee(f)},null),a(i("el-checkbox"),{key:k,label:n,value:n,onChange:f=>Q(f,n)},{default:()=>[a("span",{title:g(n),class:"inline-block w-[120px] truncate hover:text-text_color_primary"},[g(n)])]})])))?l:{default:()=>[l]})]})]})])]},ae)),a(i("el-divider"),{direction:"vertical"},null),w(a(i("iconifyIconOffline"),{class:["w-[16px]",y.value],icon:c.value?ve:he,onClick:()=>Z()},null),[[E("tippy"),c.value?"退出全屏":"全屏"]])])]),t.default({size:s.value,dynamicColumns:d.value})])])}}}),Pe=xe(Fe),je={viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Ve(e,r){return ke(),ye("svg",je,r[0]||(r[0]=[we("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1)]))}const $e=Ce({name:"ep-refresh",render:Ve});export{Pe as P,$e as R};
